/* 
  Component: Sticky Note
  統一的便利貼樣式系統
  
  使用 % 與 cqw（container query）確保各頁面比例一致：
  - 容器尺寸可不同（editor 600px、home 400px、display 600px）
  - 內部的 padding、字體、貼紙大小皆為容器的比例
*/

/* Mixins：供 editor 等頁面共用比例 */
@mixin sticky-note-font-size {
  font-size: calc(var(--font-size-pct, 4) * 1cqw);
  line-height: 1.6;
  white-space: pre-wrap;
}

@mixin sticky-note-sticker-size {
  font-size: calc(var(--font-size-pct, 4) * 2 * 1cqw);
  width: calc(var(--font-size-pct, 4) * 2 * 1cqw);
  height: calc(var(--font-size-pct, 4) * 2 * 1cqw);
}

@mixin sticky-note-sticker-img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* 便利貼圖層順序（editor 與 display 一致）：文字 1 → 手繪 2 → 貼紙 3 */
@mixin sticky-note-layer-text {
  z-index: 1;
}
@mixin sticky-note-layer-drawing {
  z-index: 2;
}
@mixin sticky-note-layer-sticker {
  z-index: 3;
}

.c-sticky-note {
  position: relative;
  width: 100%;
  aspect-ratio: 1 / 1;

  /* 啟用 container query，讓內部可使用 cqw 單位 */
  container-type: inline-size;
  container-name: sticky-note;

  /* 內層：形狀由外層 mask-image 控制、背景圖片 */
  &__inner {
    position: relative;
    width: 100%;
    height: 100%;
    padding: 8%;
    overflow: hidden;
    box-shadow:
      0 4px 6px rgba(0, 0, 0, 0.1),
      0 1px 3px rgba(0, 0, 0, 0.08);

    &:hover {
      box-shadow:
        0 10px 20px rgba(0, 0, 0, 0.15),
        0 3px 6px rgba(0, 0, 0, 0.1);
    }
  }

  /* 內容文字外包裝 - 支援位置、縮放、旋轉 */
  &__content-wrap {
    position: absolute;
    @include sticky-note-layer-text;
    transform-origin: center center;
  }

  /* 內容文字區域 - 字體比例依 scale 換行，僅與 scale 有關，可超出畫面 */
  &__content {
    width: fit-content;
    max-width: calc(100cqw / var(--text-scale, 1));
    word-break: break-word;
    @include sticky-note-font-size;
  }

  /* 貼紙元素 - 大小為文字的 2 倍（與 editor 基準一致：2em） */
  &__sticker {
    position: absolute;
    @include sticky-note-sticker-size;
    @include sticky-note-layer-sticker;
    pointer-events: none;
    user-select: none;
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;

    &-img {
      @include sticky-note-sticker-img;
    }
  }

  /* 手繪圖層 */
  &__drawing {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;
    pointer-events: none;
    user-select: none;
    @include sticky-note-layer-drawing;
  }
}

/*
  響應式：只需調整容器尺寸，不需調整內部比例
  內部使用 % / cqw 會自動跟著縮放
*/
@media (max-width: 768px) {
  .c-sticky-note {
    max-width: 100%;
  }
}

/*
  便利貼容器變體
  用於不同頁面的尺寸設定
*/
/* Home 牆面 - 400px 基準，比例與 editor/display 一致（內部用 %） */
.c-sticky-note-container--wall {
  max-width: 400px;
  width: 100%;
  margin: 0 auto;
}

/* Display 大螢幕 - 600px 基準 */
.c-sticky-note-container--display {
  max-width: 600px;
  width: 100%;
  margin: 0 auto;
}